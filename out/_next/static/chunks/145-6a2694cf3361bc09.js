(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[145],{61622:function(e,n,t){"use strict";var r=t(21321),s=t(19308),a=t(85893);n.Z=function(e){var n=e.address,t=e.className,i=(0,s.Z)(n),o=i.name,u=i.loading;return(0,a.jsx)("span",{className:(0,r.AK)(t||"","font-mono",u?"animate-pulse":""),title:n,children:o||(0,r.sC)(n)})}},39631:function(e,n,t){"use strict";var r=t(30710),s=t(19308),a=t(85893);n.Z=function(e){var n=e.peerAddress,t=(0,s.Z)(n),i=t.avatarUrl;return t.loading?(0,a.jsx)("div",{className:"animate-pulse flex",children:(0,a.jsx)("div",{className:"rounded-full bg-gray-200 h-10 w-10"})}):i?(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"w-10 h-10 rounded-full border border-n-80"}),(0,a.jsx)("img",{className:"w-10 h-10 rounded-full z-10 -mt-10",src:i,alt:n})]}):(0,a.jsx)(r.Z,{seed:n.toLowerCase(),scale:5,size:8,className:"rounded-full"})}},70224:function(e,n,t){"use strict";t.d(n,{ri:function(){return B},M9:function(){return D},V:function(){return I},PG:function(){return g}});var r,s,a=t(50029),i=t(87794),o=t.n(i),u=t(67294),c=t(11163),l=t(21321),d=t(18587),f=t(98519),p=t(85893),v=function(e){var n,t=e.recipientWalletAddress,r=e.id,s=e.name,i=e.className,c=e.placeholder,v=e.onInputChange,m=(0,d.Z)().lookupAddress,x=(0,f.q)(function(e){return e.address}),h=(0,u.useRef)(null),g=(0,u.useState)(t||""),b=g[0],w=g[1],k=(0,f.q)(function(e){return e.conversations}),j=(0,f.q)(function(e){return e.setConversations}),y=(0,f.q)(function(e){return e.client}),N=function(){var e;null===(e=h.current)||void 0===e||e.focus()};(0,u.useEffect)(function(){t||(N(),w(""))},[t]),(0,u.useEffect)(function(){var e;(e=(0,a.Z)(o().mark(function e(){var n,r,s,a;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(m){e.next=2;break}return e.abrupt("return");case 2:if(!(t&&!(0,l.MW)(t))){e.next=13;break}return e.next=5,m(t);case 5:return n=e.sent,e.next=8,null==y?void 0:y.conversations.newConversation(t);case 8:(r=e.sent)&&(k.set(t,r),j(new Map(k))),n?w(n):t&&w(t),e.next=22;break;case 13:if(!(0,l.kS)(b)){e.next=22;break}return e.next=16,null==y?void 0:y.conversations.newConversation(b);case 16:return(s=e.sent)&&(k.set(b,s),j(new Map(k))),e.next=20,m(b);case 20:(a=e.sent)&&w(a);case 22:case"end":return e.stop()}},e)})),function(){return e.apply(this,arguments)})()},[b,t,m]);var M=t===x,C=(0,l.AK)("absolute","top-[4px] md:top-[2px]","left-[26px] md:left-[23px]","rounded-2xl","px-[5px] md:px-2","border","text-md","focus:outline-none","focus:ring-0","font-bold","font-mono","overflow-visible","text-center","text-transparent","select-none",M?"bg-bt-100":"bg-zinc-50",M?"border-bt-300":"border-gray-300"),S=(0,u.useCallback)((n=(0,a.Z)(o().mark(function e(n){return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:w(n.target.value.trim()),v&&v(n);case 3:case"end":return e.stop()}},e)})),function(e){return n.apply(this,arguments)}),[v]);return(0,p.jsxs)("div",{className:"relative mb-5",children:[t&&b&&(0,p.jsx)(p.Fragment,{children:(0,p.jsx)("span",{className:C,children:b})}),(0,p.jsx)("input",{id:r,name:s,className:(0,l.AK)(i||"","absolute top-0 left-0",M?"!text-b-600":"",t?"!text-md font-bold top-[2px] left-1":""),placeholder:c,onChange:S,value:b,ref:h,autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:"false"})]})},m=t(68121),x=function(e){var n=e.onClick;return(0,p.jsxs)("button",{type:"button",className:"flex items-center justify-center h-10 w-6 rounded-full focus:outline-none focus:ring-2 focus:ring-inset focus:ring-white",onClick:n,children:[(0,p.jsx)("span",{className:"sr-only",children:"Close message view"}),(0,p.jsx)(m.Z,{className:"h-5 w-5 stroke-n-600","aria-hidden":"true"})]})},h={InvalidEntry:0,ValidEntry:1,FindingEntry:2,Submitted:3,NotOnNetwork:4},g=function(){var e,n,t,r,s,i=(0,d.Z)(),m=i.resolveName,g=i.lookupAddress,b=(0,f.q)(function(e){return e.client}),w=(0,c.useRouter)(),k=(0,l.pm)(w),j=(0,u.useState)(h.InvalidEntry),y=j[0],N=j[1],M=(0,u.useState)(!1),C=M[0],S=M[1],A=(0,u.useCallback)((e=(0,a.Z)(o().mark(function e(n){return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(null==b?void 0:b.canMessage(n))||!1);case 1:case"end":return e.stop()}},e)})),function(n){return e.apply(this,arguments)}),[b]),E=(n=(0,a.Z)(o().mark(function e(n){return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:w.push(n?"/dm/".concat(n):"/dm/");case 1:case"end":return e.stop()}},e)})),function(e){return n.apply(this,arguments)}),Z=(0,u.useCallback)(function(){w.push("/")},[w]),I=(t=(0,a.Z)(o().mark(function e(n,t){return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A(n);case 2:if(!e.sent){e.next=8;break}E(n),t.blur(),N(h.Submitted),e.next=9;break;case 8:N(h.NotOnNetwork);case 9:case"end":return e.stop()}},e)})),function(e,n){return t.apply(this,arguments)});(0,u.useEffect)(function(){var e,n=(e=(0,a.Z)(o().mark(function e(n){return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g(n);case 2:S(!!e.sent);case 4:case"end":return e.stop()}},e)})),function(n){return e.apply(this,arguments)});k&&!(0,l.MW)(k)?(N(h.Submitted),n(k)):N(h.InvalidEntry)},[g,k]);var W=(0,u.useCallback)((r=(0,a.Z)(o().mark(function e(n,t){var r,s,a,i;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),r=n.target,s=n.target,a=t||r.recipient.value,!(0,l.MW)(a)){e.next=17;break}return N(h.FindingEntry),e.next=8,m(a);case 8:if(!(i=e.sent)){e.next=14;break}return e.next=12,I(i,s);case 12:e.next=15;break;case 14:N(h.InvalidEntry);case 15:e.next=20;break;case 17:if(!(0,l.kS)(a)){e.next=20;break}return e.next=20,I(a,s);case 20:case"end":return e.stop()}},e)})),function(e,n){return r.apply(this,arguments)}),[m]),_=(0,u.useCallback)((s=(0,a.Z)(o().mark(function e(n){var t;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=n.target,"/dm"!==w.pathname&&w.push("/dm"),(0,l.MW)(t.value)||(0,l.kS)(t.value)?W(n,t.value):N(h.InvalidEntry);case 3:case"end":return e.stop()}},e)})),function(e){return s.apply(this,arguments)}),[W,w]);return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("div",{className:"md:hidden flex items-center ml-3",children:(0,p.jsx)(x,{onClick:Z})}),(0,p.jsxs)("div",{className:"flex-1 flex-col shrink justify-center flex bg-zinc-50 md:border-b md:border-gray-200 md:px-4 md:pb-[2px]",style:{backgroundColor:"white"},children:[(0,p.jsxs)("form",{className:"w-full flex pl-2 md:pl-0 h-8 pt-1",action:"#",method:"GET",onSubmit:W,children:[(0,p.jsx)("label",{htmlFor:"recipient-field",className:"sr-only",children:"Recipient"}),(0,p.jsxs)("div",{className:"relative w-full text-n-300 focus-within:text-n-600",children:[(0,p.jsx)("div",{className:"absolute top-2 left-0 flex items-center pointer-events-none text-md md:text-sm font-medium md:font-semibold",style:{zIndex:"2"},children:"To:"}),(0,p.jsx)(v,{recipientWalletAddress:k,id:"recipient-field",className:"block w-[95%] pl-7 md:ms-[3px] pr-3 pt-[3px] md:pt-[2px] md:pt-[5px] bg-transperant caret-n-600 text-n-600 placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-0 focus:border-transparent text-lg font-mono",name:"recipient",onInputChange:_})]}),(0,p.jsx)("button",{type:"submit",className:"hidden"})]}),y===h.Submitted?(0,p.jsx)("div",{className:"text-md text-n-300 text-sm font-mono ml-10 md:ml-8 pb-1 md:pb-[1px]",children:C?k:(0,p.jsx)("br",{})}):(0,p.jsxs)("div",{className:"text-sm md:text-xs text-n-300 ml-[29px] pl-2 md:pl-0 pb-1 md:pb-[3px]",children:[y===h.NotOnNetwork&&"Recipient is not on the XMTP network",y===h.FindingEntry&&"Finding ENS domain...",y===h.InvalidEntry&&"Please enter a valid wallet address",y===h.ValidEntry&&(0,p.jsx)("br",{})]})]})]})},b=t(95872),w=t(39631),k=t(61622),j=function(e){var n=e.address,t=n===(0,f.q)(function(e){return e.address});return(0,p.jsx)(k.Z,{className:(0,l.AK)("rounded-2xl","border","text-md","mr-2","px-2","py-1","font-bold",t?"bg-bt-100 text-b-600":"bg-zinc-50",t?"border-bt-300":"border-gray-300"),address:n})},y=t(47734),N=t.n(y),M=function(){var e=(0,u.useState)([0,0]),n=e[0],t=e[1];return(0,u.useLayoutEffect)(function(){function e(){t([window.innerWidth,window.innerHeight])}return window.addEventListener("resize",e),e(),function(){return window.removeEventListener("resize",e)}},[]),n},C=function(e){var n,t=e.message;return(0,p.jsxs)("div",{className:"flex items-start mx-auto mb-4",children:[(0,p.jsx)(w.Z,{peerAddress:t.senderAddress}),(0,p.jsxs)("div",{className:"ml-2 max-w-[95%]",children:[(0,p.jsxs)("div",{children:[(0,p.jsx)(j,{address:t.senderAddress}),(0,p.jsx)("span",{className:"text-sm font-normal place-self-end text-n-300 text-md uppercase",children:(0,l.mr)(t.sent)})]}),(0,p.jsx)("span",{className:"block text-md px-2 mt-2 text-black font-normal break-words",children:t.error?"Error: ".concat(null===(n=t.error)||void 0===n?void 0:n.message):(0,p.jsx)(b.ZP,{text:t.content||""})})]})]})},S=function(e){var n=e.children;return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("div",{className:"grow h-0.5 bg-gray-300/25"}),n,(0,p.jsx)("div",{className:"grow h-0.5 bg-gray-300/25"})]})},A=function(e){var n=e.date;return(0,p.jsx)("div",{className:"flex align-items-center items-center pb-8 pt-4",children:(0,p.jsx)(S,{children:(0,p.jsx)("span",{className:"mx-11 flex-none text-gray-300 text-sm font-bold",children:null==n?void 0:n.toLocaleString("en-US",{year:"numeric",month:"long",day:"numeric"})})})})},E=function(){return(0,p.jsx)("div",{className:"flex align-items-center justify-center pb-4 mt-4",children:(0,p.jsx)("span",{className:"text-gray-300 text-sm font-semibold",children:"This is the beginning of the conversation"})})},Z=function(){return(0,p.jsx)("div",{className:"p-1 mt-6 text-center text-gray-300 font-bold text-sm",children:"Loading Messages..."})},I=u.memo(function(e){var n,t=e.messages,r=e.fetchNextMessages,s=e.hasMore,a=M();return(0,p.jsx)(N(),{dataLength:t.length,next:r,className:"flex flex-col-reverse overflow-y-auto pl-4",height:a[1]>700?"87vh":"83vh",inverse:!0,endMessage:(0,p.jsx)(E,{}),hasMore:s,loader:(0,p.jsx)(Z,{}),children:null==t?void 0:t.map(function(e,t){var r,s,a=!!n&&(r=n,s=e.sent,(null==r?void 0:r.toDateString())!==(null==s?void 0:s.toDateString())),i=(0,p.jsxs)("div",{children:[(0,p.jsx)(C,{message:e}),a?(0,p.jsx)(A,{date:n}):null]},"".concat(e.id,"_").concat(t));return n=e.sent,i})})}),W=t(79022),_=t.n(W);function T(){return(T=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e}).apply(this,arguments)}var q=function(e){return u.createElement("svg",T({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 26 26",width:"1em",height:"1em"},e),r||(r=u.createElement("path",{fill:"#2EC053",fillRule:"evenodd",d:"M13 25.8c7.07 0 12.8-5.73 12.8-12.8S20.07.2 13 .2.2 5.93.2 13 5.93 25.8 13 25.8Zm5.931-13.931-4.8-4.8a1.6 1.6 0 0 0-2.262 0l-4.8 4.8A1.6 1.6 0 1 0 9.33 14.13l2.069-2.068V17.8a1.6 1.6 0 0 0 3.2 0v-5.737l2.069 2.068a1.6 1.6 0 1 0 2.262-2.262Z",clipRule:"evenodd"})))};function O(){return(O=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e}).apply(this,arguments)}var P=function(e){return u.createElement("svg",O({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 26 26",width:"1em",height:"1em"},e),s||(s=u.createElement("path",{fill:"#989CA7",fillRule:"evenodd",d:"M13 25.8c7.07 0 12.8-5.73 12.8-12.8S20.07.2 13 .2.2 5.93.2 13 5.93 25.8 13 25.8Zm5.931-13.931-4.8-4.8a1.6 1.6 0 0 0-2.262 0l-4.8 4.8A1.6 1.6 0 1 0 9.33 14.13l2.069-2.068V17.8a1.6 1.6 0 1 0 3.2 0v-5.737l2.069 2.068a1.6 1.6 0 1 0 2.262-2.262Z",clipRule:"evenodd"})))},L=t(25675),R=t.n(L),D=function(e){var n,t=e.onSend,r=(0,u.useState)(""),s=r[0],i=r[1],d=(0,c.useRouter)();(0,u.useEffect)(function(){return i("")},[d.query.recipientWalletAddr]);var f=(n=(0,a.Z)(o().mark(function e(n){return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),s){e.next=3;break}return e.abrupt("return");case 3:return i(""),e.next=6,t(s);case 6:case"end":return e.stop()}},e)})),function(e){return n.apply(this,arguments)});return(0,p.jsx)("div",{className:(0,l.AK)("bg-white","flex","items-center"),children:(0,p.jsxs)("form",{className:(0,l.AK)("flex","m-2","w-full","border","py-2","pl-4","mr-3","drop-shadow-xl","mt-0",_().bubble),autoComplete:"off",onSubmit:f,children:[(0,p.jsx)("input",{type:"text",placeholder:"Type something...",className:(0,l.AK)("block","w-full","text-md","md:text-sm",_().input),name:"message",value:s,onChange:function(e){return i(e.currentTarget.value)},required:!0}),(0,p.jsx)("button",{type:"submit",className:_().arrow,children:s?(0,p.jsx)(R(),{src:q,alt:"send",height:32,width:32}):(0,p.jsx)(R(),{src:P,alt:"send",height:32,width:32})})]})})},U=t(36121),z=t(4346),F=function(e,n){var t,r=(0,f.q)(function(n){return n.convoMessages.get(e)}),s=(0,f.q)(function(n){return n.conversations.get(e)}),i=(0,f.q)(function(e){return e.addMessages}),c=(0,u.useState)(new Map),d=c[0],p=c[1];return(0,u.useEffect)(function(){var t;s&&(t=(0,a.Z)(o().mark(function t(){var r;return o().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.messages({direction:z.SortDirection.SORT_DIRECTION_DESCENDING,limit:l.kY,endTime:n});case 2:(r=t.sent).length>0?(i(e,r),r.length<l.kY?(d.set(e,!1),p(new Map(d))):(d.set(e,!0),p(new Map(d)))):(d.set(e,!1),p(new Map(d)));case 4:case"end":return t.stop()}},t)})),function(){return t.apply(this,arguments)})()},[s,e,n]),{convoMessages:r,hasMore:null!==(t=d.get(e))&&void 0!==t&&t}},K=function(e){var n;return{sendMessage:(0,u.useCallback)((n=(0,a.Z)(o().mark(function n(t){return o().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,null==e?void 0:e.send(t);case 2:case"end":return n.stop()}},n)})),function(e){return n.apply(this,arguments)}),[e])}},B=u.memo(function(e){var n,t=e.recipientWalletAddr,r=(0,f.q)(function(e){return e.conversations}).get(t),s=(0,l.n2)(r),a=K(r).sendMessage,i=(0,u.useState)(new Map),o=i[0],c=i[1],d=F(s,o.get(s)),v=d.convoMessages,m=d.hasMore,x=(0,f.q)(function(e){return e.loadingConversations}),h=(0,u.useCallback)(function(){if(m&&Array.isArray(v)&&v.length>0&&s){var e=v[v.length-1].sent,n=o.get(s);(!n||e<=n)&&(o.set(s,e),c(new Map(o)))}},[s,m,v,o]),g=Number(null!==(n=null==v?void 0:v.length)&&void 0!==n?n:0)>0;return x&&!g?(0,p.jsx)(U.ZP,{headingText:"Loading messages...",subHeadingText:"Please wait a moment",isLoading:!0}):(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("div",{className:"bg-white h-[calc(100vh-7rem)]",children:(0,p.jsx)("div",{className:"h-full flex justify-between flex-col",children:(0,p.jsx)(I,{fetchNextMessages:h,messages:null!=v?v:[],hasMore:m})})}),(0,p.jsx)(D,{onSend:a})]})})},36121:function(e,n,t){"use strict";var r=t(56091),s=t.n(r),a=t(85893),i=function(e){return e.isLoading?(0,a.jsxs)("div",{className:s()["lds-roller"],children:[(0,a.jsx)("div",{}),(0,a.jsx)("div",{}),(0,a.jsx)("div",{}),(0,a.jsx)("div",{}),(0,a.jsx)("div",{}),(0,a.jsx)("div",{}),(0,a.jsx)("div",{}),(0,a.jsx)("div",{})]}):null};n.ZP=function(e){var n=e.headingText,t=e.subHeadingText,r=e.isLoading;return(0,a.jsx)("div",{className:"grid place-items-center h-full mt-2",children:(0,a.jsxs)("div",{className:"columns-1 text-center",children:[(0,a.jsx)(i,{isLoading:r}),n&&(0,a.jsx)("div",{className:"text-xl md:text-lg text-n-200 md:text-n-300 font-bold",children:n}),(0,a.jsx)("div",{className:"text-lx md:text-md text-n-200 font-normal",children:t})]})})}},21321:function(e,n,t){"use strict";function r(){for(var e=arguments.length,n=Array(e),t=0;t<e;t++)n[t]=arguments[t];return n.filter(Boolean).join(" ")}t.d(n,{kY:function(){return x},AK:function(){return r},p6:function(){return s.p6},mr:function(){return s.mr},pm:function(){return s.pm},Sf:function(){return c},n2:function(){return s.n2},dU:function(){return i},kS:function(){return s.kS},MW:function(){return s.MW},XS:function(){return p},sC:function(){return s.sC},us:function(){return v},HH:function(){return o},$G:function(){return s.$G},xO:function(){return m}});var s=t(16754),a=t(34155),i=function(){var e=a.env.NEXT_PUBLIC_XMTP_ENVIRONMENT;return"production"===e||"local"===e?e:"dev"},o=function(){return"production"===i()?null:i().toLocaleUpperCase()},u=JSON.parse('{"u2":"xmtp-react-chat-example","i8":"1.0.0"}'),c=function(){return u.u2+"/"+u.i8},l=t(48764).Buffer,d="binary",f=function(e){return"xmtp:".concat(i(),":keys:").concat(e)},p=function(e){var n=localStorage.getItem(f(e));return n?l.from(n,d):null},v=function(e,n){localStorage.setItem(f(e),l.from(n).toString(d))},m=function(e){localStorage.removeItem(f(e))},x=20},16754:function(e,n,t){"use strict";t.d(n,{$G:function(){return r},MW:function(){return i},kS:function(){return o},mr:function(){return a},n2:function(){return c},p6:function(){return s},pm:function(){return l},sC:function(){return u}});var r=function(e,n){return e&&e.length>n?"".concat(e.substring(0,n-3),"..."):e},s=function(e){return e?e.toLocaleDateString("en-US"):""},a=function(e){return e?e.toLocaleTimeString(void 0,{hour12:!0,hour:"numeric",minute:"2-digit"}):""},i=function(e){return e.endsWith("eth")||e.endsWith(".cb.id")},o=function(e){return e.startsWith("0x")&&42===e.length},u=function(e){return e.length>10&&e.startsWith("0x")?"".concat(e.substring(0,6),"...").concat(e.substring(e.length-4)):e},c=function(e){var n,t,r;return null!=e&&null!==(n=e.context)&&void 0!==n&&n.conversationId?"".concat(null==e?void 0:e.peerAddress,"/").concat(null==e?void 0:null===(t=e.context)||void 0===t?void 0:t.conversationId):null!==(r=null==e?void 0:e.peerAddress)&&void 0!==r?r:""},l=function(e){return Array.isArray(e.query.recipientWalletAddr)?e.query.recipientWalletAddr[0]:e.query.recipientWalletAddr}},19308:function(e,n,t){"use strict";var r=t(50029),s=t(87794),a=t.n(s),i=t(67294),o=t(16754),u=t(18587);n.Z=function(e){var n=(0,u.Z)(),t=n.resolveName,s=n.lookupAddress,c=n.getAvatarUrl,l=(0,i.useState)(""),d=l[0],f=l[1],p=(0,i.useState)(""),v=p[0],m=p[1],x=(0,i.useState)(""),h=x[0],g=x[1],b=(0,i.useState)(!0),w=b[0],k=b[1],j=e&&(0,o.kS)(e)?e:void 0,y=e&&(0,o.MW)(e)?e:void 0;return(0,i.useEffect)(function(){if(t&&s&&c){var e,n,i,o=(e=(0,r.Z)(a().mark(function e(n){return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=g,e.next=3,c(n);case 3:e.t1=e.sent,(0,e.t0)(e.t1);case 5:case"end":return e.stop()}},e)})),function(n){return e.apply(this,arguments)}),u=(n=(0,r.Z)(a().mark(function e(n){return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return k(!0),e.t0=m,e.next=4,s(n);case 4:if(e.t1=e.sent,(0,e.t0)(e.t1),!v){e.next=9;break}return e.next=9,o(v);case 9:k(!1);case 10:case"end":return e.stop()}},e)})),function(e){return n.apply(this,arguments)}),l=(i=(0,r.Z)(a().mark(function e(n){return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return k(!0),e.t0=f,e.next=4,t(n);case 4:return e.t1=e.sent,(0,e.t0)(e.t1),e.next=8,o(n);case 8:k(!1);case 9:case"end":return e.stop()}},e)})),function(e){return i.apply(this,arguments)});j&&u(j),y&&l(y)}},[y,j,v,t,s,c]),{address:j||d,name:y||v,avatarUrl:h,loading:w}}},18587:function(e,n,t){"use strict";var r,s=t(50029),a=t(87794),i=t.n(a),o=t(67294),u=t(94413),c=t(42484),l=t.n(c),d=t(64488),f=t(80983),p=t(11163),v=t(98519),m=t(34155),x=new Map,h=new Map,g=new Map;n.Z=function(){var e,n,t,a=(0,v.q)(function(e){return e.web3Modal}),b=(0,v.q)(function(e){return e.setWeb3Modal}),w=(0,v.q)(function(e){return e.setAddress}),k=(0,v.q)(function(e){return e.setSigner}),j=(0,v.q)(function(e){return e.reset}),y=(0,p.useRouter)(),N=(0,o.useCallback)((e=(0,s.Z)(i().mark(function e(n){var t,s,a;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!h.has(n)){e.next=2;break}return e.abrupt("return",h.get(n));case 2:return e.next=4,null===(t=r)||void 0===t?void 0:t.getNetwork();case 4:if(e.t0=e.sent,e.t0){e.next=7;break}e.t0={};case 7:if(!(1!==Number(e.t0.chainId))){e.next=11;break}return e.abrupt("return",void 0);case 11:return e.next=13,null===(s=r)||void 0===s?void 0:s.resolveName(n);case 13:if(e.t1=e.sent,e.t1){e.next=16;break}e.t1=void 0;case 16:return a=e.t1,h.set(n,a),e.abrupt("return",a);case 19:case"end":return e.stop()}},e)})),function(n){return e.apply(this,arguments)}),[]),M=(0,o.useCallback)((n=(0,s.Z)(i().mark(function e(n){var t,s,a;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!x.has(n)){e.next=2;break}return e.abrupt("return",x.get(n));case 2:return e.next=4,null===(t=r)||void 0===t?void 0:t.getNetwork();case 4:if(e.t0=e.sent,e.t0){e.next=7;break}e.t0={};case 7:if(!(1!==Number(e.t0.chainId))){e.next=11;break}return e.abrupt("return",void 0);case 11:return e.next=13,null===(s=r)||void 0===s?void 0:s.lookupAddress(n);case 13:if(e.t1=e.sent,e.t1){e.next=16;break}e.t1=void 0;case 16:return a=e.t1,x.set(n,a),e.abrupt("return",a);case 19:case"end":return e.stop()}},e)})),function(e){return n.apply(this,arguments)}),[]),C=(0,o.useCallback)((t=(0,s.Z)(i().mark(function e(n){var t,s;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!g.has(n)){e.next=2;break}return e.abrupt("return",g.get(n));case 2:return e.next=4,null===(t=r)||void 0===t?void 0:t.getAvatar(n);case 4:if(e.t0=e.sent,e.t0){e.next=7;break}e.t0=void 0;case 7:return s=e.t0,g.set(n,s),e.abrupt("return",s);case 10:case"end":return e.stop()}},e)})),function(e){return t.apply(this,arguments)}),[]),S=(0,o.useCallback)(function(){Object.keys(localStorage).forEach(function(e){e.startsWith("xmtp")&&localStorage.removeItem(e)}),j(),y.push("/")},[y,a]),A=(0,o.useCallback)(function(){S()},[S]),E=(0,o.useCallback)((0,s.Z)(i().mark(function e(){var n,t;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a){e.next=2;break}throw Error("web3Modal not initialized");case 2:return e.prev=2,e.next=5,a.connect();case 5:if(n=e.sent){e.next=8;break}return e.abrupt("return");case 8:return n.on("accountsChanged",A),k(t=(r=new u.ethers.providers.Web3Provider(n,"any")).getSigner()),e.t0=w,e.next=15,t.getAddress();case 15:return e.t1=e.sent,(0,e.t0)(e.t1),e.abrupt("return",t);case 20:e.prev=20,e.t2=e.catch(2),console.log("error",e.t2);case 23:case"end":return e.stop()}},e,null,[[2,20]])})),[A,a]);return(0,o.useEffect)(function(){var e,n=m.env.NEXT_PUBLIC_INFURA_ID,t={walletconnect:{package:d.Z,options:{infuraId:n}}};window.ethereum&&(!window.ethereum||window.ethereum.isCoinbaseWallet)||(t.walletlink={package:f.ZP,options:{appName:"Chat via XMTP",infuraId:n}}),window.ethereum&&window.ethereum.isMetaMask||(t["custom-metamask"]={display:{logo:c.providers.METAMASK.logo,name:"Install MetaMask",description:"Connect using browser wallet"},package:{},connector:(e=(0,s.Z)(i().mark(function e(){return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:window.open("https://metamask.io");case 1:case"end":return e.stop()}},e)})),function(){return e.apply(this,arguments)})}),a||b(new(l())({cacheProvider:!0,providerOptions:t}))},[]),(0,o.useEffect)(function(){var e;a&&(e=(0,s.Z)(i().mark(function e(){var n,t,s,o;return i().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,n=localStorage.getItem("WEB3_CONNECT_CACHED_PROVIDER")){e.next=4;break}return e.abrupt("return");case 4:return t=JSON.parse(n),e.next=7,a.connectTo(t);case 7:if(s=e.sent){e.next=10;break}return e.abrupt("return");case 10:return s.on("accountsChanged",A),k(o=(r=new u.ethers.providers.Web3Provider(s,"any")).getSigner()),e.t0=w,e.next=17,o.getAddress();case 17:e.t1=e.sent,(0,e.t0)(e.t1),e.next=24;break;case 21:e.prev=21,e.t2=e.catch(0),console.error(e.t2);case 24:case"end":return e.stop()}},e,null,[[0,21]])})),function(){return e.apply(this,arguments)})()},[a]),{resolveName:N,lookupAddress:M,getAvatarUrl:C,connect:E,disconnect:S}}},98519:function(e,n,t){"use strict";t.d(n,{q:function(){return i}});var r=t(76687),s=t(64529),a=function(e){var n=(0,r.Z)(Array.from(new Map(e.map(function(e){return[e.id,e]})).values()));return n.sort(function(e,n){var t,r,s,a;return(null!==(t=null===(r=n.sent)||void 0===r?void 0:r.getTime())&&void 0!==t?t:0)-(null!==(s=null===(a=e.sent)||void 0===a?void 0:a.getTime())&&void 0!==s?s:0)}),null!=n?n:[]},i=(0,s.ZP)(function(e){return{web3Modal:void 0,setWeb3Modal:function(n){return e(function(){return{web3Modal:n}})},signer:void 0,setSigner:function(n){return e(function(){return{signer:n}})},address:void 0,setAddress:function(n){return e(function(){return{address:n}})},client:void 0,setClient:function(n){return e(function(){return{client:n}})},conversations:new Map,setConversations:function(n){return e(function(){return{conversations:n}})},loadingConversations:!1,setLoadingConversations:function(n){return e(function(){return{loadingConversations:n}})},convoMessages:new Map,previewMessages:new Map,setPreviewMessage:function(n,t){return e(function(e){var r=new Map(e.previewMessages);return r.set(n,t),{previewMessages:r}})},setPreviewMessages:function(n){return e(function(){return{previewMessages:n}})},addMessages:function(n,t){var s=0;return e(function(e){var i=new Map(e.convoMessages),o=e.convoMessages.get(n)||[],u=a([].concat((0,r.Z)(o),(0,r.Z)(t)));return(s=u.length-o.length)?(i.set(n,u),{convoMessages:i}):{convoMessages:e.convoMessages}}),s},reset:function(){return e(function(){return{client:void 0,conversations:new Map,convoMessages:new Map,previewMessages:new Map,address:void 0,signer:void 0}})}}})},56091:function(e){e.exports={"lds-roller":"Loader_lds-roller__T1pce"}},79022:function(e){e.exports={bubble:"MessageComposer_bubble__WphSy",input:"MessageComposer_input__rSJ7B",arrow:"MessageComposer_arrow__7cU2I"}},88677:function(){},46601:function(){},89214:function(){},85568:function(){},52361:function(){},94616:function(){},6567:function(){},42602:function(){}}]);